<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>4 Color Cards Generator (Easy Input)</title>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
    body {
        font-family: sans-serif;
        padding: 20px;
        background-color: #f0f2f5;
        margin: 0;
    }

    .controls {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-bottom: 20px;
    }

    .control-row {
        background: #fff;
        border-radius: 12px;
        padding: 15px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        align-items: center;
    }

    .control-row h3 {
        grid-column: 1 / -1;
        margin: 0 0 8px 0;
        font-size: 14px;
        color: #666;
    }

    input[type="text"] {
        width: 100%;
        padding: 10px;
        font-size: 16px; /* ズーム防止 */
        border: 1px solid #ddd;
        border-radius: 6px;
        box-sizing: border-box;
    }

    input[type="color"] {
        width: 100%;
        height: 40px;
        border: 1px solid #ddd;
        border-radius: 6px;
        background: none;
        cursor: pointer;
    }

    .action-bar {
        position: sticky;
        top: 0;
        background: #f0f2f5;
        padding: 10px 0;
        z-index: 100;
        display: flex;
        justify-content: center;
    }

    .download-btn {
        width: 100%;
        max-width: 400px;
        padding: 15px;
        font-size: 18px;
        font-weight: bold;
        color: white;
        background-color: #007AFF;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0,122,255,0.3);
    }

    .download-btn:active {
        background-color: #0056b3;
        transform: scale(0.98);
    }

    #capture-area {
        display: block;
        text-align: center;
        margin-top: 20px;
    }

    .card {
        width: 450px;
        height: 160px;
        padding: 25px;
        border-radius: 25px;
        margin: 0 auto 25px auto;
        position: relative;
        box-sizing: border-box;
        text-align: left;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .label {
        position: absolute;
        bottom: 20px;
        left: 25px;
        font-weight: bold;
        font-size: 26px;
        line-height: 1.2em;
    }

    .code {
        font-size: 20px;
        opacity: 0.9;
        font-weight: normal;
    }
</style>
</head>

<body>

<div class="action-bar">
    <button class="download-btn" onclick="downloadImage()">画像を保存する</button>
</div>

<div class="controls">
    <div class="control-row">
        <h3>カード 1</h3>
        <input id="label1" type="text" value="MINT GREEN">
        <input id="color1" type="color" value="#B9ECFF">
    </div>
    <div class="control-row">
        <h3>カード 2</h3>
        <input id="label2" type="text" value="SILVER GREEN">
        <input id="color2" type="color" value="#A8D8FF">
    </div>
    <div class="control-row">
        <h3>カード 3</h3>
        <input id="label3" type="text" value="PINK">
        <input id="color3" type="color" value="#FFD0EC">
    </div>
    <div class="control-row">
        <h3>カード 4</h3>
        <input id="label4" type="text" value="WHITE">
        <input id="color4" type="color" value="#FFFFFF">
    </div>
</div>

<div id="capture-area">
    <div id="card1" class="card"><div class="label"><span></span><br><span class="code"></span></div></div>
    <div id="card2" class="card"><div class="label"><span></span><br><span class="code"></span></div></div>
    <div id="card3" class="card"><div class="label"><span></span><br><span class="code"></span></div></div>
    <div id="card4" class="card"><div class="label"><span></span><br><span class="code"></span></div></div>
</div>

<script>
// 色名判定ロジックは保持
const COLOR_NAMES = [
  { name: "White", rgb: [255,255,255] }, { name: "Silver", rgb: [192,192,192] },
  { name: "Sky Blue", rgb: [135,206,235] }, { name: "Mint Green", rgb: [189,252,201] },
  { name: "Pink", rgb: [255,192,203] }, { name: "Red", rgb: [255,0,0] },
  { name: "Black", rgb: [0,0,0] }, { name: "Navy", rgb: [0,0,128] }
];

function hexToRgb(hex) {
    const r = parseInt(hex.slice(1, 3), 16);
    const g = parseInt(hex.slice(3, 5), 16);
    const b = parseInt(hex.slice(5, 7), 16);
    return [r, g, b];
}

function getClosestColorName(hex) {
    const [r, g, b] = hexToRgb(hex);
    let closest = "Color";
    let minDistance = Infinity;
    COLOR_NAMES.forEach(c => {
        const distance = Math.pow(r - c.rgb[0], 2) + Math.pow(g - c.rgb[1], 2) + Math.pow(b - c.rgb[2], 2);
        if (distance < minDistance) {
            minDistance = distance;
            closest = c.name;
        }
    });
    return closest;
}

function updateCard(i) {
    const colorInput = document.getElementById(`color${i}`);
    const labelInput = document.getElementById(`label${i}`);
    const card = document.getElementById(`card${i}`);
    const spans = card.querySelectorAll("span");

    const color = colorInput.value;

    // 名前が未入力 or 自動モードなら更新
    if (!labelInput.dataset.manual || labelInput.value === "") {
        labelInput.value = getClosestColorName(color).toUpperCase();
        labelInput.dataset.manual = "";
    }

    card.style.background = color;
    spans[0].textContent = labelInput.value;
    spans[1].textContent = color.toUpperCase();

    const [r, g, b] = hexToRgb(color);
    const brightness = (r * 299 + g * 587 + b * 114) / 1000;
    card.querySelector(".label").style.color = brightness > 180 ? "#555" : "#fff";
}

// リアルタイム反映のイベント登録
for (let i = 1; i <= 4; i++) {
    const colorInp = document.getElementById(`color${i}`);
    const labelInp = document.getElementById(`label${i}`);

    colorInp.addEventListener("input", () => updateCard(i));
    labelInp.addEventListener("input", () => {
        labelInp.dataset.manual = "true";
        updateCard(i);
    });
}

function downloadImage() {
    const area = document.getElementById("capture-area");
    html2canvas(area, { backgroundColor: null, scale: 2 }).then(canvas => {
        const link = document.createElement("a");
        link.href = canvas.toDataURL("image/png");
        link.download = "color-palette.png";
        link.click();
    });
}

// 初期実行
for (let i = 1; i <= 4; i++) updateCard(i);

</script>
</body>
</html>
